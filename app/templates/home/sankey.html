<!-- app/templates/home/sankey.html -->

{% import "bootstrap/wtf.html" as wtf %}
{% extends "base.html" %}
{% block head %}

  <script src="//d3js.org/d3.v4.min.js"></script>
  <script>var d4 = d3;</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter2/1.3.14/crossfilter.js" type='text/javascript'></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dc/2.1.1/dc.min.js" type='text/javascript'></script>
  <link href="{{ url_for('static', filename='dist/css/tabulator.min.css') }}" rel="stylesheet">
  <script src="{{ url_for('static', filename='js/sankey/d3-sankey-circular.js') }}"></script>
  <script src="{{ url_for('static', filename='js/sankey/d3-scale-chromatic.v1.min.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/spatiotemptable/tabulator.min.js') }}"></script>
  <link href="https://fonts.googleapis.com/css?family=Roboto:100i" rel="stylesheet">
  <link href="{{ url_for('static', filename='dist/css/tabulator_modern.min.css') }}" rel="stylesheet">        

  <style>
    body {
      font-family: 'Roboto', sans-serif;
      /*background: #E3D4C1;*/
      /*background: #000;*/
    }

    rect {
      shape-rendering: crispEdges;
    }

    text {
      /*text-shadow: 0 1px 0 #fff;*/
      font-size: 12px;
      /*font-family: 'Roboto', sans-serif;*/
      font-family: monospace;
      /*fill: white;*/
    }

    .link {
      fill: none;
    }
  </style>
  <script>
    var pageTexts = {{ pageDicts|tojson }},
        nodes = {{ nodes|tojson }},
        edges = {{ edges|tojson}},
        data = {{ sankeyData|tojson }};
  </script>
  

  {% endblock %}

  <!-- Title -->
  {% block title %}Dashboard{% endblock %}
  
  <!-- Body -->
  {% block body %}
  <center>
    
    <div id="firstText" class="text-justify col-md-8"></div>

    <div class="container">
      <div class="row">
          <div id="From-table" class="col-md-3" style="height:300; width:400;"></div>
          <div id="To-table" class="col-md-3" style="height:300; width:400;"></div>
          <div class="col-md-6" id="chart"></div>
      </div>
      <div id="vertical-whitespace" style="padding: 10px"></div>
      <div class="row">
        <button class="ny-btn databaseButton" onclick="saveData()">Commit to Database</button>
      </div>
    </div>

    <div id="secondText" class="text-justify col-md-8"></div>
  </center>
  
  <script src="{{ url_for('static', filename='js/sankey/sankey.js') }}"></script>
  <script src="{{ url_for('static', filename='js/sankey/sankeyTable.js') }}"></script>

  <script type="text/javascript">
    pageKeys = Object.keys(pageTexts.sankey)
  
    console.log(pageKeys)
    for (var i = pageKeys.length - 1; i >= 0; i--) {
        d3.select("#" + pageKeys[i]).html(pageTexts.sankey[pageKeys[i]])
    }
  </script>
  {% endblock %}